{% include 'FrontFrontBundle::flashbags.html.twig'%}

{{ form_start(edit_profile_form, { 'attr' : { 'id' : 'userProfilForm' } } ) }}
{{ form_errors(edit_profile_form) }}

{{ form_row(edit_profile_form.username) }}
{{ form_row(edit_profile_form.userTypes) }}
{{ form_row(edit_profile_form.musicTypes) }}

{{ form_row(edit_profile_form.submit) }}

{{ form_end(edit_profile_form) }}

{{ form_start(delete_form, { 'attr' : { 'id' : 'userDeleteForm', 'class' : 'no_validation' } } ) }}
{{ form_errors(delete_form) }}
{{ form_row(delete_form.submit, { 'id' : 'userDeleteButton' } ) }}
{{ form_end(delete_form) }}

<script type="text/javascript">
    $(document).ready(function () {
        $('form:not(.no_validation)').bootstrapValidator({
            fields: {
                "ffup[username]": {
                    validators: {
                        remote: {
                            message: "{% trans from 'validators' %}fos_user.username.already_used{% endtrans %}",
                            url: '{{ path('callback_username') }}',
                            delay: 1000
                        }
                    }
                }
            }
        });

        $("#userDeleteButton").on("click", function (e) {
            e.preventDefault();
            if (!confirm("{% trans %}user.delete.confirmation{% endtrans %}")) {
                return false;
            }
            {#var bootstrapValidator = $("#userDeleteForm").data('bootstrapValidator');
            bootstrapValidator.validate();
            if (bootstrapValidator.isValid())#}
                $("#userDeleteForm").submit();
            {#else
                return;#}
        });

    });
</script>