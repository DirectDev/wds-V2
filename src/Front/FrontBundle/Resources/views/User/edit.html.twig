{% extends 'FrontFrontBundle::layout.html.twig' %}

{% block title %}
    {{ entity.username|capitalize }}
{% endblock %}

{% block content %}

    <div class="page-banner">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h2>{{ entity.username|capitalize }}</h2>
                </div>
                <div class="col-md-6">
                    <div class='pull-right'>
                        <a href="{{ path('front_user_show_private') }}" class="btn btn-warning btn-sm pull-right">
                            <i class="glyphicon glyphicon-arrow-left"></i>
                            <span> {% trans %}front.back{% endtrans %}</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="content">
        <div class="container">

            {% form_theme edit_form with ['FrontFrontBundle:Form:bootstrap_form_override.html.twig'] %}

            {{ form_errors(edit_form) }}
            {#            {{ form_errors(edit_form.addresses) }}#}

            <div class="recent-projects">  

                <h4 class="classic-title"><span>{% trans %}user.user_title{% endtrans %}</span></h4>


                {{ form_start(edit_form) }}
                {{ form_errors(edit_form) }}

                {{ form_row(edit_form.username) }}
                
                {{ form_row(edit_form.userTypes) }}
                {{ form_row(edit_form.musicTypes) }}
                
                {{ form_row(edit_form.translations) }}
                {{ form_row(edit_form.facebook_link) }}
                {{ form_row(edit_form.google_link) }}
                {{ form_row(edit_form.linkedin_link) }}
                {{ form_row(edit_form.twitter_link) }}
                {{ form_row(edit_form.flickr_link) }}
                {{ form_row(edit_form.tumblr_link) }}
                {{ form_row(edit_form.vimeo_link) }}
                {{ form_row(edit_form.instagram_link) }}


                {#<h4 class="classic-title"><span>{% trans %}user.addresses_title{% endtrans %}</span></h4>
                    <ul class="addresses" data-prototype="{{ form_widget(edit_form.addresses.vars.prototype)|e }}">
                        {% for address in edit_form.addresses %}
                            <li>
                                {{ form_row(address.name) }}
                                {{ form_row(address.street) }}
                                {{ form_row(address.streetComplement) }}
                                {{ form_row(address.postcode) }}
                                {{ form_row(address.city) }}                                    
                                {{ form_row(address.country) }}         
                            </li>
                        {% endfor %}
                    </ul>#}

                <div class='row'>
                    <div class='col-md-1 pull-right'>
                        {{ form_row(edit_form.submit) }}
                    </div>
                </div>

                {{ form_end(edit_form) }}

                <h4 class="classic-title"><span>{% trans %}user.images_title{% endtrans %}</span></h4>
                <div class='panel-footer'>
                    {% set action_path = path('front_user_edit' , { id: entity.id, editId: editId }) %}
                    {% include 'FileFileBundle::uploadFileForm.html.twig' with {
                        action_path: action_path,
                        cancel_path: 'front_user_show_private',
                        delete_path: '',
                        id: entity.id, 
                        editId: editId, 
                        existingFiles: existingFiles,
                        entity: entity,
                } %}
                </div>

            </div>

        </div>
    </div>
                
                
    <script type="text/javascript">
        $(document).ready(function () {
            $('form').bootstrapValidator({
                fields: {
                    "front_frontbundle_user[username]": {
                        validators: {
                            remote: {
                                message: "{% trans from 'validators' %}fos_user.username.already_used{% endtrans %}",
                                url: '{{ path('callback_username') }}'
                            }
                        }
                    }
                }
            });
        });
    </script> 


    {#<script>
        
        var $collectionHolderAddress;

        // setup an "add a address" link
        var $addLinkAddress = $("<a href=' class='add_address_link'>{% trans %}front.link_add_address{% endtrans %}</a>");
        var $newLinkLiAddress = $('<li></li>').append($addLinkAddress);
        var $removeFormAAddress = $("<a href='#'>{% trans %}front.link_delete_address{% endtrans %}</a>");

        jQuery(document).ready(function() {
            // Get the ul that holds the collection of addresss
            $collectionHolderAddress = $('ul.addresses');

            $collectionHolderAddress.find('li').each(function() {
                addFormDeleteLink($(this));
            });

            // add the "add a address" anchor and li to the addresss ul
            $collectionHolderAddress.append($newLinkLiAddress);

            // count the current form inputs we have (e.g. 2), use that as the new
            // index when inserting a new item (e.g. 2)
            $collectionHolderAddress.data('index', $collectionHolderAddress.find(':input').length);

            $addLinkAddress.on('click', function(e) {
                // prevent the link from creating a "#" on the URL
                e.preventDefault();

                // add a new address form (see next code block)
                addForm($collectionHolderAddress, $newLinkLiAddress);
                
                //efface le lien pour qu'il n'y ai qu'une addresse
                $addLinkAddress.hide();
                
            });
            
            {% if edit_form.addresses|length %}
                $addLinkAddress.hide();
            {% endif %}
        });

        function addForm($collectionHolderAddress, $newLinkLiAddress) {
            // Get the data-prototype explained earlier
            var prototype = $collectionHolderAddress.data('prototype');

            // get the new index
            var index = $collectionHolderAddress.data('index');

            // Replace '__name__' in the prototype's HTML to
            // instead be a number based on how many items we have
            //var newForm = prototype.replace(/__name__/g, index);
            var newForm = prototype.replace(/__name__/g, index);

            // increase the index with one for the next item
            $collectionHolderAddress.data('index', index + 1);

            // Display the form in the page in an li, before the "Add a address" link li
            var $newFormLi = $('<li></li>').append(newForm);
            $newLinkLiAddress.before($newFormLi);

            addFormDeleteLink($newFormLi);
        }

        function addFormDeleteLink($FormLi) {
            
            $FormLi.append($removeFormAAddress);

            $removeFormAAddress.on('click', function(e) {
                // prevent the link from creating a "#" on the URL
                e.preventDefault();

                // remove the li for the  form
                $FormLi.remove();
                
                $addLinkAddress.show();
            });

        }
        
        
    </script> #}


{% endblock %}    

{% block bottomJavascripts %}
    {{ parent() }}
    <script src="{{ asset('js/underscore-min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/punkavefileuploader/js/jquery.fileupload.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/punkavefileuploader/js/jquery.iframe-transport.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/punkavefileuploader/js/FileUploader.js') }}" type="text/javascript"></script> 
{% endblock %}  